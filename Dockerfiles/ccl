# docker buildx  build --tag ccl --file ccl .
# docker run -it --rm --name ccl ccl

ARG ROOT_CONTAINER=jupyter/minimal-notebook

ARG BASE_CONTAINER=$ROOT_CONTAINER
FROM $BASE_CONTAINER

LABEL maintainer="Ruben Gamboa <ruben@uwyo.edu>"

ENV CCL_DEFAULT_DIRECTORY=/usr/local/src/ccl

USER root

WORKDIR /usr/local/src/

RUN set -x \
    && apt-get update -y \
    && apt-get install -y --no-install-recommends wget ca-certificates rlwrap \
    && apt-get install wget rlwrap \
    && wget "https://github.com/Clozure/ccl/releases/download/v1.13/ccl-1.13-linuxx86.tar.gz" \
    && tar xzf ccl-1.13-linuxx86.tar.gz \
    && cp ccl/scripts/ccl64 /usr/local/bin/ccl \
    && rm ccl-1.13-linuxx86.tar.gz

USER $NB_UID

WORKDIR /

ENTRYPOINT ["rlwrap", "ccl"]
